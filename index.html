<html>
<head>
<!-- DOCUMENTATION https://github.com/Aerolab/blockrain.js/ -->
<!-- The stylesheet should go in the <head>, or be included in your CSS -->
<link rel="stylesheet" href="blockrain_custom.css">
<style>
body{ margin:0 auto; }
button {
  border: none;
  color: white;
  padding: 0px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 20px;
  margin-left: 5px;
  margin-top: 6px;
  margin-bottom: 6px;
  cursor: pointer;
  height: 90px;
  display: block;
  width: 100%;
}
.verde{ background-color: #28a745; }
.rosso{ background-color: #dc3545; }
.blu{ background-color: #007bff; }
.arancione{ background-color: #ffc107; }
</style>
<!-- jQuery and Blockrain.js -->
<script src="jquery.js"></script>
<script src="blockrain.jquery.js"></script>
</head>
<body>
<div class="game" style="width:250px; height:580px;float:left; display:block"></div>
<div class="control" style="float:left; display:block; width:90px; height:580px; valign:bottom">
<button class='verde' id='pause'>Pause</button>
<button class='rosso' id='rleft'><img src='assets/control/rotate_left.png' /></button>
<button class='blu' id='rright'><img src='assets/control/rotate_right.png' /></button>
<button class='rosso' id='left'><img src='assets/control/left.png' /></button>
<button class='blu' id='right'><img src='assets/control/right.png' /></button>
<button class='arancione' id='down'>Down</button>
</div>
<div style="clear:both;"></div>
<script>
    $('.game').blockrain();
    // Pause
    $( "#pause" ).click(function() {
    	var text = $( "#pause" ).text();
    	if (text === 'Pause' ){
    		$('#pause').text("Resume");
  			$('.game').blockrain('pause');
    	}
    	else{
    		$('#pause').text("Pause");
  			$('.game').blockrain('resume');
    	}
	});

	//Rotate Right 38
    $( "#rright" ).click(function() {    
    	var key = 38;
    	simulateKey(key);
	});

	//Rotate Left 90
    $( "#rleft" ).click(function() {    
    	var key = 90;
    	simulateKey(key);
	});

	//Right 39
    $( "#right" ).click(function() {    
    	var key = 39;
    	simulateKey(key);
	});

	//Left 37
    $( "#left" ).click(function() {    
    	var key = 37;
    	simulateKey(key);
	});

	//Down 40
    $( "#down" ).click(function() {    
    	var key = 40;
    	simulateKey(key);
	});

function simulateKey (keyCode, type, modifiers) {
	var evtName = (typeof(type) === "string") ? "key" + type : "keydown";	
	var modifier = (typeof(modifiers) === "object") ? modifier : {};
	var event = document.createEvent("HTMLEvents");
	event.initEvent(evtName, true, false);
	event.keyCode = keyCode;
	for (var i in modifiers) {
		event[i] = modifiers[i];
	}
	document.dispatchEvent(event);
	var evtName = (typeof(type) === "string") ? "key" + type : "keyup";	
	var modifier = (typeof(modifiers) === "object") ? modifier : {};
	var event = document.createEvent("HTMLEvents");
	event.initEvent(evtName, true, false);
	event.keyCode = keyCode;
	for (var i in modifiers) {
		event[i] = modifiers[i];
	}
	document.dispatchEvent(event);
}
// Setup some tests
var onKeyEvent = function (event) {
	var state = "pressed";
		if (event.type !== "keypress") {
		state = event.type.replace("key", "");
	}
	console.log("Key with keyCode " + event.keyCode + " is " + state);
};

document.addEventListener("keypress", onKeyEvent, false);
document.addEventListener("keydown", onKeyEvent, false);
document.addEventListener("keyup", onKeyEvent, false);

</script>
</body>
</html>